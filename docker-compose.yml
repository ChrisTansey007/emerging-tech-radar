version: "3.8"

services:
  innovation_system_app: # Defines a service named 'innovation_system_app'
    build:
      context: . # Sets the build context to the current directory (project root)
      dockerfile: innovation_system/Dockerfile # Specifies the Dockerfile to use
    container_name: emerging_tech_radar_app # Assigns a specific name to the container

    volumes:
      # Mounts the host's ./innovation_system/data directory to /app/innovation_system/data in the container.
      # This ensures data persistence for Parquet files, SQLite DB, etc., generated by the app.
      # The '/app' prefix matches the WORKDIR in the Dockerfile.
      - ./innovation_system/data:/app/innovation_system/data

      # Mounts the host's system_monitor.log file to /app/system_monitor.log in the container.
      # This allows the log file generated by the app (which runs in /app) to be persisted on the host.
      # Note: If system_monitor.log is in innovation_system/ directory, adjust path.
      # Assuming it's at project root as per previous log config.
      - ./system_monitor.log:/app/system_monitor.log

    env_file:
      # Loads environment variables from the .env file located in the project root on the host.
      # These variables will be available to the application inside the container.
      - .env

    # Default command arguments appended to the Dockerfile's ENTRYPOINT.
    # The ENTRYPOINT is ["python", "innovation_system/main/run.py"].
    # These become arguments to main/run.py.
    command: >
      --sectors "AI,Biotech"
      --start-date "2023-01-01"
      --end-date "2023-01-07"
      --horizons "6,12"
      --force-collect

    # Uncomment these if you need to interact with the container or keep it running for debugging.
    # tty: true
    # stdin_open: true
